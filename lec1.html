<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Biostatistics Module</title>
    <meta charset="utf-8" />
    <meta name="author" content="Victor Ritter" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Biostatistics Module
## R Lab
### Victor Ritter
### UNC-CH
### 20/01/2020

---




## About the R Lab

.pull-left[
### Instructor
  
Victor Ritter &lt;br/&gt;
_Statistician_ (BS,MS) &lt;br/&gt;
_Brazilian_
  
_Biostatistics_ PhD Student &lt;br/&gt;
University North Carolina  &lt;br/&gt; at Chapel Hill
]

--
.pull-right[![](./images/br.png)]

--
### About you?

Previous Statistical analysis software? e.g. SPSS, SAS, Minitab, Stata

Previous programming experience?

---
## Goal

Capacitance students to conduct autonomous statistical analysis using R

--
## Lab structure and assignments

Meeting from 2 to 5 pm with ~15 min break

--

- **Part 1:** coding and R programming

--

- **Part 2:** how to do statistical analysis in R

--

- **Part 3:** practice

  - Week 1 - R exercises
  
  - Week 2 - Data analysis project
  
  - Ask questions ("how do I do _this_ in R?")
  
---
## Today's Agenda

--

- Reproducible research

--

- Starting with R and RStudio

--

- Basic descriptive statistics in R

---
class: center, middle, inverse
# Part I-a
# Motivation &lt;br/&gt; Reproducible Research


---
## Reproducibility

- Important to ensure the "self-correcting" aspect of science

- Health sciences currently on a "reproducibility crisis"

![:border](./images/nature.png)

.pull-left[
- Statistical methods play an important role on reproducibility
  - (_right_) Wassertein and Lazar (2016), _Am. Stat._ editorial 
  
- Google "reproducibility crisis"
]

.pull-right[
  ![:border](./images/ASA_comment.png)
]

---
## Reproducibility

- Experimental Psychology research

![:border](./images/ex1.png)
.caption[The "Many Labs" Project (https://osf.io/wx7ck/)]

---
## Reproducibility

- Cancer research

![:border](./images/ex2.png)

  - Some studies are inherently irreproducible

--
- Two types of replication

  - &lt;mark&gt;  Reproduce reported results with same data (reanalysis) &lt;mark&gt;
  
  - Replicate the entire experiment

---
## Reproducible statistical analysis

Important steps for making reproducible analysis are

--
- Proper knowledge of the statistical methods
  - Be conscious about **P-hacking** (searching for and selective reporting of "statistically significant" results) and **HARKing** - Hypothesizing After the Results are Known - reporting _post hoc_ hypothesis as if they were a priori hypothesis

--
- Follow guidelines and protocols when possible
  - NIH (US) resources for consultation
    https://grants.nih.gov/policy/reproducibility/index.htm
  
  - Robust data management protocol
  
  - Organization and transparency
--

- Make use of the technology available
    - Dynamic/interactive reports (&lt;mark&gt; Rmarkdown, R Notebook &lt;mark&gt;) 
    
    - Version Control tools (Git, Github)

---
class: middle, center
## Why a Version Control software?

![](./images/git.jpg)

---
## Other initiatives for reproducibility

 - **EQUATOR Network** Reporting guidelines (https://www.equator-network.org/reporting-guidelines/)
   - Provide guidelines for many study designs
   
.center[![:border](./images/strobe.png)]
--

 - Registered reports - **Center for Open Science** (https://cos.io/rr/)
.center[![:scale 80%](./images/cos.png)]

---
class: middle, center, inverse
# Part I-b
# Getting Started with &lt;br/&gt; R and Rstudio

---
## R Popularity ðŸ’°

.center[![:scale 70%](./images/rjobs.png)]
http://r4stats.com/articles/popularity/

---
## R Popularity ðŸŽ“

.center[![:scale 53%](./images/rhits.png)]
http://r4stats.com/articles/popularity/

---
## Things that R is **good** at?

- _Data analysis_ - created by statisticians for statisticians

- _Visualization_ - powerful and flexible data visualization tools

- _Integration_ with other tools/languages - easy communication with SPSS, SAS, Excel, SQL, Spark, Hadoop, C/C++, Python, JavaScript, tensorflow, etc...

- Facilitates reproducibility
--

## Things that R is **not so good** good at?

- _Ease-of-use_ - steep(er) initial learning curve requires some knowledge of coding

- _Speed_ - can be slow(er) in certain tasks - e.g. loops, web scrapping

---
## R without Rstudio

.center[![:border](./images/r.png)]
.caption[Native R GUI]

---
## R with Rstudio

Early 2011, things changed...
.center[![:scale 80%](./images/rstudio.png)]

---
## Exploring Rstudio

- R IDE (Integrated Development Environment)

- Let's explore a couple RStudio Menus/Tabs

- Customize your RStudio (pane locations and colors)
--

- Useful shortcuts:
  - **'Ctrl + Enter'** - send current/selected line(s) to console
  - **'Ctrl + Alt + b'** - send code up to current line
  - **'Ctrl + Shift + c'** - comment/uncomment current/selected line(s)
  - **'Ctrl + Shift + m'** - insert pipe operator ('%&gt;%')
  - **'Alt + -'** - insert assign operator (' &lt;- ')
  - **'Ctrl + Shift + k'** - knit RMarkdown file
  - Use **'up'** arrow key to navigate console's history 

???

knit = tejer (terrer)

---
## You've opened RStudio, now what?

Getting to know the R ecosystem:

- _Script_: develop/write/test code

- _Console_: code interpreted immediately and output is shown

- _Workspace_: directory where R is running and reading/writing files from/to

  - **Important** to be aware if your current workspace (use **`getwd()`**)
  
  - Change your workspace directory using **`setwd()`** or in RStudio's 'Session' menu

---
class: center, middle, inverse
# Let's code...

&lt;img src="https://media.giphy.com/media/o0vwzuFwCGAFO/giphy.gif" style = "display: block; margin-left: auto; margin-right: auto;"&gt;

---
## R as a calculator

.pull-left[

```r
# addition
1 + 1
```

```
&gt; [1] 2
```

```r
# subtraction
4 - 2
```

```
&gt; [1] 2
```

```r
# multiplication
2 * 3
```

```
&gt; [1] 6
```

```r
# division
5 / 3
```

```
&gt; [1] 1.666667
```
]

.pull-right[

```r
# power
4 ^ 2
```

```
&gt; [1] 16
```

```r
# Reminder of the division
# of 5 by 3
5 %% 3
```

```
&gt; [1] 2
```

```r
# Integer part of the
# division of 5 by 3
5 %/% 3  
```

```
&gt; [1] 1
```
]


---
## Objects in R

- Atomic (single value)

- Vectors (sequence of values)

- Matrices (2-dimensional vectors)

- Data frames (matrix with data from different types)

- List (data from different times with possibly unequal lengths)

---
## Atomic objects in R

.pull-left[

```r
# numeric
1.2
```

```
&gt; [1] 1.2
```

```r
# character
"Hello"
```

```
&gt; [1] "Hello"
```

```r
# integer
10L
```

```
&gt; [1] 10
```
]

.pull-right[

```r
# logical
TRUE #or just T
```

```
&gt; [1] TRUE
```

```r
FALSE #or just F
```

```
&gt; [1] FALSE
```
]

---
## Atomic objects in R

Creation and assignment of values to objects

.pull-left[

```r
x &lt;- 2.14
x
```

```
&gt; [1] 2.14
```

```r
y = T
y
```

```
&gt; [1] TRUE
```

```r
z &lt;- "1"
z
```

```
&gt; [1] "1"
```
]

.pull-right[

Now we can do


```r
x * 100
```

```
&gt; [1] 214
```

```r
x + y
```

```
&gt; [1] 3.14
```

```r
x + z
Error in x + z: non-numeric
argument to binary operator
```
]

---
## Vectors

Think of an indexed collection of atomic objects (of same type)


```r
x &lt;- c(10, 20, 30, 40)
x
```

```
&gt; [1] 10 20 30 40
```

```r
x[1]
```

```
&gt; [1] 10
```
--

- Concatenate objects to create a vector using the **`c()`** _function_
- Access elements of a vector using the **`[ ]`** syntax
- Keep in mind that indexes in R start at 1.
- Some types trump others (`character &gt; numeric &gt; integer &gt; logical`)


```r
x &lt;- c(10, "A")
x
```

```
&gt; [1] "10" "A"
```

---
## Matrices


```r
m &lt;- matrix(1:6, nrow = 2, ncol = 3)
m
```

```
&gt;      [,1] [,2] [,3]
&gt; [1,]    1    3    5
&gt; [2,]    2    4    6
```

```r
m[1,1]
```

```
&gt; [1] 1
```

```r
m[2,]
```

```
&gt; [1] 2 4 6
```

```r
m[,3]
```

```
&gt; [1] 5 6
```

---
## Lists


```r
x &lt;- list(1:5, "Z", TRUE, c("a", "b"))
x
```

```
&gt; [[1]]
&gt; [1] 1 2 3 4 5
&gt; 
&gt; [[2]]
&gt; [1] "Z"
&gt; 
&gt; [[3]]
&gt; [1] TRUE
&gt; 
&gt; [[4]]
&gt; [1] "a" "b"
```

```r
x[[2]]
```

```
&gt; [1] "Z"
```

---
## Data frames

Think of it as Excel spreadsheets


```r
x &lt;- data.frame(var1 = 1:3, var2 = c("A", "B", "C"))
x
```

```
&gt;   var1 var2
&gt; 1    1    A
&gt; 2    2    B
&gt; 3    3    C
```

```r
x$var1
```

```
&gt; [1] 1 2 3
```

```r
x[,2]
```

```
&gt; [1] A B C
&gt; Levels: A B C
```

---
## Functions

We can call a function doing

```r
function_name(argument1, argument2, ...)
```

Like the **`length`** function


```r
x &lt;- 1:10
x
```

```
&gt;  [1]  1  2  3  4  5  6  7  8  9 10
```

```r
length(x)
```

```
&gt; [1] 10
```

---
## Useful functions


```r
# Create a sequence
seq(from = 0, to = 10, by = 2)
```

```
&gt; [1]  0  2  4  6  8 10
```

```r
# no need to write all arguments' names
seq(0, 10, 2)
```

```
&gt; [1]  0  2  4  6  8 10
```

```r
# Repeat a pattern
rep(c("M", "F"), 5)
```

```
&gt;  [1] "M" "F" "M" "F" "M" "F" "M" "F" "M" "F"
```

```r
# Sort
sort(c(1, 35, 29, -19))
```

```
&gt; [1] -19   1  29  35
```

---
## Useful functions

Comparing values 

```r
2 &lt;= 3
```

```
&gt; [1] TRUE
```

```r
2 == as.numeric("2")
```

```
&gt; [1] TRUE
```

```r
x &lt;- 1:5
x &gt; 3
```

```
&gt; [1] FALSE FALSE FALSE  TRUE  TRUE
```

```r
sum(x &gt; 3)
```

```
&gt; [1] 2
```

---
## Useful functions

Comparing vectors


```r
x &lt;- 1:5
y &lt;- 7:3

comp &lt;- rep(NA, 5)
comp
```

```
&gt; [1] NA NA NA NA NA
```

```r
for(i in 1:5){
  comp[i] &lt;- x[i] &gt; y[i] # Element-wise comparison
}
comp
```

```
&gt; [1] FALSE FALSE FALSE FALSE  TRUE
```

```r
ifelse(x &gt; y, 1, 0) # Vectorized version
```

```
&gt; [1] 0 0 0 0 1
```

---
## Useful functions

Generating random numbers


```r
x &lt;- rnorm(100, mean = 2, sd = 1)
x[1:5]
```

```
&gt; [1] 2.904551 2.064265 1.938571 2.850220 1.236719
```

```r
hist(x)
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---
## Asking for help()

- If you want more info about a specific function, e.g. `seq()`, you can do

```r
help(seq)
```

same as 
```r
?seq
```

- In RStudio, press F1 with your cursor is on top of the function name

- If you don't know if there is a function to perform an specific task (most likely there is), you can try searching the R function catalog with &lt;br/&gt; `??&lt;search term&gt;`

- Easier to just Google it. All official (and unofficial) R documentation is available online

---
## RStudio cheat sheets

The RStudio company created a series of quick access guides to help people familiarize themselves with broad R capabilities

https://rstudio.com/resources/cheatsheets/

.center[![:border](./images/cheat.png)]

---
## Resources for learning R

- RStudio publishes a lot of R/RStudio free resources

  - RStudio Webnar Series
  https://resources.rstudio.com/webinars

--

  - RStudio publications (free ebooks and tutorials)
  
.center[![:border](./images/rbooks.png)]

--

  - Literally, all over the internet. Just be careful with your Stats methods sources. There is a lot of junk statistics written online

---
class:center

## Final comment about R

- It's a language in constant and rapid evolution.

- I constantly "Google" stuff that I know how to do just to see if a new technique shows up

---
class: middle, center
## Part II
## Descriptive Analysis

---
## Quantitative and qualitative data

- Quantitative data (continuous, counts) can be stored as **numeric**

- Qualitative data (nominal or ordinal) can be stored as **factors**


```r
gender &lt;- rep(c("F", "M"), times = 3:2)
gender
```

```
&gt; [1] "F" "F" "F" "M" "M"
```

```r
gender &lt;- as.factor(gender)
gender
```

```
&gt; [1] F F F M M
&gt; Levels: F M
```

- Creating categorical variable from continuous data

```r
age &lt;- rnorm(100, 25, 2)
age_cat &lt;- cut(age, breaks = c(0, 10, 25, 99))
age_cat[1:5]
```

```
&gt; [1] (10,25] (25,99] (10,25] (10,25] (25,99]
&gt; Levels: (0,10] (10,25] (25,99]
```

---
## Measures of location


```r
x &lt;- sample.int(5, 30, replace = T)
x[1:5]
```

```
&gt; [1] 1 5 3 3 3
```

```r
mean(x)
```

```
&gt; [1] 2.866667
```

```r
median(x)
```

```
&gt; [1] 3
```

```r
quantile(x, probs = c(.25, .5, .75))
```

```
&gt; 25% 50% 75% 
&gt;   2   3   4
```

---
## Measures of location


```r
table(x)
```

```
&gt; x
&gt; 1 2 3 4 5 
&gt; 6 6 8 6 4
```

```r
prop.table(table(x))
```

```
&gt; x
&gt;         1         2         3         4         5 
&gt; 0.2000000 0.2000000 0.2666667 0.2000000 0.1333333
```

- Finding the mode manually


```r
freq &lt;- table(x)
freq[freq == max(freq)]
```

```
&gt; 3 
&gt; 8
```


---
## Measures of spread and shape


```r
z &lt;- rnorm(100, mean = 10, sd = 2)
var(x)
```

```
&gt; [1] 1.774713
```

```r
sd(x)
```

```
&gt; [1] 1.332183
```

```r
range(x) # returns min/max values
```

```
&gt; [1] 1 5
```

```r
max(x) - min(x)
```

```
&gt; [1] 4
```

```r
IQR(x)
```

```
&gt; [1] 2
```

```r
quantile(x, .75) - quantile(x, .25)
```

```
&gt; 75% 
&gt;   2
```

---
## Measures of spread and shape

Let's compute Skewness and Kurtosis manually


```r
centered_moment &lt;- function(x, r = 2) {
  n &lt;- length(x)
  m &lt;- mean(x)
  return(sum((x - m)^r/n))
}

m2 &lt;- centered_moment(z, 2)
m3 &lt;- centered_moment(z, 3)
m4 &lt;- centered_moment(z, 4)

# Skewness
m3/(m2^1.5)
```

```
&gt; [1] 0.2315873
```

```r
# Kurtosis
m4/(m2^2)
```

```
&gt; [1] 2.360322
```

---
## Frequency table


```r
head(mtcars)
```

```
&gt;                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
&gt; Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
&gt; Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
&gt; Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

```r
freq &lt;- table(mtcars$gear)
prop.table(freq)
```

```
&gt; 
&gt;       3       4       5 
&gt; 0.46875 0.37500 0.15625
```

---
## Contingency table


```r
freq &lt;- table(mtcars$vs, mtcars$am)
freq
```

```
&gt;    
&gt;      0  1
&gt;   0 12  6
&gt;   1  7  7
```

--


```r
freq &lt;- xtabs(~ vs + am, data = mtcars)
freq
```

```
&gt;    am
&gt; vs   0  1
&gt;   0 12  6
&gt;   1  7  7
```

- **xtabs()** is useful when you already have collapsed data
---
## Histogram


```r
hist(mtcars$mpg, main = "Histogram of mpg",
     xlab = " Miles/(US) gallon")
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;

---
## Histogram


```r
hist(mtcars$mpg, freq = FALSE)
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;

---
## Box-plot


```r
boxplot(mtcars$mpg)
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /&gt;

---
## Box-plot


```r
boxplot(mpg ~ cyl, data = mtcars,
        ylab = "Miles per gallon",
        xlab = "Number of cylinders")
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /&gt;

---
## Scatterplot


```r
plot(x = mtcars$wt, y = mtcars$hp,
     pch = 20, col = 2, las = 1, cex=2)
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-31-1.png" style="display: block; margin: auto;" /&gt;

---
## Barplot


```r
dt &lt;- rbind(c(122, 167, 528, 673),
            c(203, 118, 178, 212))

barplot(dt, main = "Survival of Each Class",
        xlab = "Class", col = c("red","green"))
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /&gt;

---
## Barplot


```r
barplot(dt, main = "Survival of Each Class",
        xlab = "Class", col = c("red","green"),
        beside = TRUE)
legend("topleft", c("Not survived","Survived"),
       fill = c("red","green"))
```

&lt;img src="lec1_files/figure-html/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
